<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ğŸ”‹ æ–°èƒ½æºåŸºé‡‘æ“ä½œå»ºè®®ï¼ˆå®æµ‹å¯ç”¨ç‰ˆï¼‰</title>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; padding: 20px; background: #f9fafb; }
    .container { max-width: 800px; margin: 0 auto; }
    h1 { text-align: center; color: #0d6efd; margin-bottom: 24px; }
    .data-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee; }
    .label { color: #4a5568; }
    .value { font-weight: bold; color: #1a73e8; }
    .error { color: #e53e3e; }
    #advice { margin-top: 24px; padding: 16px; background: #fff8e1; border-left: 4px solid #ffc107; }
    #update-time { text-align: center; margin-top: 24px; color: #718096; font-size: 0.9em; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ”‹ æ–°èƒ½æºåŸºé‡‘æ“ä½œå»ºè®®</h1>
    
    <div id="data-panel">
      <div class="data-row">
        <span class="label">åŸºé‡‘ï¼ˆ001158ï¼‰å‡€å€¼ï¼š</span>
        <span class="value" id="fund-value">â€”</span>
      </div>
      <div class="data-row">
        <span class="label">åˆ›ä¸šæ¿æŒ‡ï¼ˆ399006ï¼‰ï¼š</span>
        <span class="value" id="cyb-value">â€”</span>
      </div>
      <div class="data-row">
        <span class="label">æ–°èƒ½æºæŒ‡æ•°ï¼ˆ399808ï¼‰ï¼š</span>
        <span class="value" id="ne-value">â€”</span>
      </div>
      <div class="data-row">
        <span class="label">æˆäº¤é¢ï¼ˆäº¿å…ƒï¼‰ï¼š</span>
        <span class="value" id="volume-value">â€”</span>
      </div>
    </div>

    <div id="advice">ç­‰å¾…æ•°æ®åŠ è½½...</div>
    <div id="update-time">æœ€è¿‘æ›´æ–°ï¼šâ€”</div>
  </div>

  <script>
    let fund = null, cyb = null, ne = null, volume = null;

    function updateUI() {
      const el = (id, text) => document.getElementById(id).textContent = text;
      
      el('fund-value', fund ? fund.toFixed(4) : 'â€”');
      el('cyb-value', cyb ? Math.round(cyb) : 'â€”');
      el('ne-value', ne ? Math.round(ne) : 'â€”');
      el('volume-value', volume ? (volume / 1e8).toFixed(0) : 'â€”');

      const allLoaded = fund && cyb && ne && volume;
      if (!allLoaded) {
        el('advice', 'âŒ æ•°æ®åŠ è½½ä¸­æˆ–éƒ¨åˆ†å¤±è´¥ï¼Œè¯·åˆ·æ–°');
        return;
      }

      // ç®€å•é€»è¾‘ï¼šä»…ä½œç¤ºä¾‹ï¼Œä½ å¯æŒ‰éœ€è°ƒæ•´
      let advice = "ğŸŸ¡ æŒæœ‰è§‚æœ›";
      if (ne > 4800 && volume > 800) {
        advice = "ğŸ”´ é«˜ä½æ”¾é‡ï¼Œå»ºè®®å‡ä»“";
      } else if (ne < 4000 && fund < 2.0) {
        advice = "ğŸŸ¢ ä½ä½åŒºåŸŸï¼Œå¯è€ƒè™‘å®šæŠ•";
      }
      el('advice', advice);

      const now = new Date();
      el('update-time', `æœ€è¿‘æ›´æ–°ï¼š${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-${String(now.getDate()).padStart(2,'0')} ${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`);
    }

    // === 1. åŸºé‡‘å‡€å€¼ï¼ˆå¤©å¤©åŸºé‡‘ï¼‰===
    const fundScript = document.createElement('script');
    fundScript.src = `https://fundgz.1234567.com.cn/js/001158.js?_=${Date.now()}`;
    window.jsonpgz = (data) => {
      if (data?.dwjz) fund = parseFloat(data.dwjz);
      updateUI();
    };
    document.head.appendChild(fundScript);

    // === 2. åˆ›ä¸šæ¿æŒ‡ï¼ˆæ–°æµªï¼‰===
    window.hq_str_sz399006 = (data) => {
      const parts = data.split(',');
      if (parts.length > 1) cyb = parseFloat(parts[1]);
      updateUI();
    };
    const cybScript = document.createElement('script');
    cybScript.src = `https://hq.sinajs.cn/list=sz399006&_=${Date.now()}`;
    document.head.appendChild(cybScript);

    // === 3. æ–°èƒ½æºæŒ‡æ•°ï¼ˆæ–°æµªï¼‰===
    window.hq_str_sz399808 = (data) => {
      const parts = data.split(',');
      if (parts.length > 8) {
        ne = parseFloat(parts[1]);
        volume = parseFloat(parts[8]); // æˆäº¤é¢ï¼Œå•ä½ï¼šå…ƒ
      }
      updateUI();
    };
    const neScript = document.createElement('script');
    neScript.src = `https://hq.sinajs.cn/list=sz399808&_=${Date.now()}`;
    document.head.appendChild(neScript);
  </script>
</body>
</html>
